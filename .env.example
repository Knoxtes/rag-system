# ============================================================================
# RAG SYSTEM - ENVIRONMENT CONFIGURATION
# For: ask.7mountainsmedia.com
# Plesk Obsidian 18.0.74 | AlmaLinux 9.7 | Node.js 22.25.1 | Python 3.9
# ============================================================================
# üîí SECURITY: Copy this file to .env and fill in your actual values
# DO NOT commit .env, credentials.json, or token.pickle to version control!
# ============================================================================

# ----------------------------------------------------------------------------
# Google Cloud Configuration (REQUIRED)
# ----------------------------------------------------------------------------
# Get your API key from: https://aistudio.google.com/app/apikey
GOOGLE_API_KEY=your_google_gemini_api_key_here

# Your Google Cloud project ID (must have Vertex AI enabled)
PROJECT_ID=rag-chatbot-475316
LOCATION=us-central1

# ----------------------------------------------------------------------------
# Google OAuth (REQUIRED for Google Drive integration)
# ----------------------------------------------------------------------------
# Get from Google Cloud Console > APIs & Services > Credentials
GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-client-secret

# OAuth Redirect URI
# ‚ö†Ô∏è CRITICAL: Must match EXACTLY what you configured in Google Cloud Console
# Production: https://ask.7mountainsmedia.com/auth/callback
OAUTH_REDIRECT_URI=https://ask.7mountainsmedia.com/auth/callback

# Organization Access Control
# Only users with @7mountainsmedia.com email can access
ALLOWED_DOMAINS=7mountainsmedia.com

# ----------------------------------------------------------------------------
# Flask Security Configuration (REQUIRED)
# ----------------------------------------------------------------------------
# üîê GENERATE NEW SECRET KEYS FOR PRODUCTION!
# Generate with: python3 -c "import secrets; print(secrets.token_hex(32))"
FLASK_SECRET_KEY=CHANGE-THIS-generate-a-random-32-byte-hex-string
JWT_SECRET_KEY=CHANGE-THIS-generate-a-different-32-byte-hex-string

# Token Configuration
TOKEN_EXPIRY_HOURS=168
REFRESH_TOKEN_EXPIRY_DAYS=30

# Environment mode
FLASK_ENV=production
NODE_ENV=production
DEBUG=False
LOG_LEVEL=INFO

# Flask server port (internal)
FLASK_PORT=5001

# ----------------------------------------------------------------------------
# CORS Configuration
# ----------------------------------------------------------------------------
# Comma-separated list of allowed origins for production
# Production: only your domain
CORS_ORIGINS=https://ask.7mountainsmedia.com

# ----------------------------------------------------------------------------
# Server Configuration
# ----------------------------------------------------------------------------
# Port for Node.js proxy server (public-facing)
PORT=3000

# ----------------------------------------------------------------------------
# Google Drive Configuration
# ----------------------------------------------------------------------------
# Your shared drive ID (if using shared drives)
SHARED_DRIVE_ID=your-shared-drive-id-here

# Google Drive OAuth Redirect URI (for admin file browser)
GDRIVE_REDIRECT_URI=https://ask.7mountainsmedia.com/admin/gdrive/callback

# ----------------------------------------------------------------------------
# Rate Limiting (Optional - defaults provided)
# ----------------------------------------------------------------------------
# Requests per minute per user
RATE_LIMIT_PER_MINUTE=50

# ----------------------------------------------------------------------------
# Vertex AI Configuration (Optional - uses smart defaults)
# ----------------------------------------------------------------------------
# Set to 'true' to use Vertex AI embeddings (recommended for production)
USE_VERTEX_AI=true

# Gemini model to use
GEMINI_MODEL=gemini-2.5-flash

# ----------------------------------------------------------------------------
# ChromaDB Configuration (Optional)
# ----------------------------------------------------------------------------
# Path to vector database storage
CHROMA_PERSIST_DIR=./chroma_db

# ----------------------------------------------------------------------------
# Performance Tuning (Optional - defaults provided)
# ----------------------------------------------------------------------------
# Number of results to retrieve for reranking
TOP_K_RESULTS=20

# Maximum context characters to send to LLM
MAX_CONTEXT_CHARACTERS=8000

# Query cache TTL in seconds
CACHE_TTL_SECONDS=900

# Maximum agent iterations to prevent infinite loops
MAX_AGENT_ITERATIONS=5

# ----------------------------------------------------------------------------
# Redis Cache (Optional - for production performance)
# ----------------------------------------------------------------------------
# Enable Redis for persistent caching across restarts (40-60% cost reduction)
USE_REDIS_CACHE=false

# Redis connection settings (only needed if USE_REDIS_CACHE=true)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# ----------------------------------------------------------------------------
# Advanced Performance Settings (Optional)
# ----------------------------------------------------------------------------
# Enable parallel collection search (60-70% faster multi-collection queries)
ENABLE_PARALLEL_SEARCH=true

# Max concurrent workers for parallel search
MAX_PARALLEL_WORKERS=5

# Enable lazy loading (90% faster startup - 60s to 5s)
ENABLE_LAZY_LOADING=true

# Enable response compression for large responses (70-80% faster transfer)
ENABLE_RESPONSE_COMPRESSION=true

# Compression threshold in bytes (compress responses larger than this)
COMPRESSION_THRESHOLD=50000

# Enable semantic cache for similar query matching (30-40% more cache hits)
ENABLE_SEMANTIC_CACHE=true

# Semantic similarity threshold for cache hits (0.0-1.0)
SEMANTIC_CACHE_THRESHOLD=0.90

# ----------------------------------------------------------------------------
# Logging Configuration (Optional)
# ----------------------------------------------------------------------------
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log file path
LOG_FILE=./logs/chat_api.log

# Max log file size in bytes (10MB default)
LOG_MAX_BYTES=10485760

# Number of backup log files to keep
LOG_BACKUP_COUNT=5

# ----------------------------------------------------------------------------
# Security Headers (Optional - for production)
# ----------------------------------------------------------------------------
# Enable security headers
ENABLE_SECURITY_HEADERS=true

# Content Security Policy
CSP_HEADER=default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'

# ----------------------------------------------------------------------------
# Admin Configuration (Optional)
# ----------------------------------------------------------------------------
# Comma-separated list of admin email addresses
ADMIN_EMAILS=admin@yourdomain.com,manager@yourdomain.com

# ============================================================================
# NOTES:
# ============================================================================
# 1. Required credentials file: credentials.json (Google Cloud service account)
# 2. token.pickle will be auto-generated on first OAuth flow
# 3. indexed_folders.json tracks indexed collections
# 4. See PLESK_DEPLOYMENT.md for deployment instructions
# 5. See PRODUCTION_CHECKLIST.md for production readiness verification
# ============================================================================
